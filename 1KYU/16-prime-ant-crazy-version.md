### Problem:
<p><strong><em>PLEASE RATE AND RANK THE KATA IF YOU SOLVED IT, TO HELP IT GET OUT OF BETA. THANKS!</em></strong></p>
<hr>
<h2 id="preface">Preface</h2>
<p>This is the crazy hard version of the <a href="https://www.codewars.com/kata/prime-ant-performance-version/" target="_blank">Prime Ant - Performance Version</a> kata. If you did not complete it yet, you should begin there.</p>
<h2 id="description-task-and-examples">Description, task and examples</h2>
<p>Everything is exactly the same as in the previous version (see above). You should <strong>really</strong> complete that first, then take your solution here and get started!</p>
<h2 id="tests">Tests</h2>
<p>Now this is where we&apos;re going crazy! You will have <strong>2000</strong> test cases in the 10<sup>6</sup> to 2 * 10<sup>6</sup>  range. Sounds too much? No, it isn&apos;t: the reference solution can do almost the double before timing out. Sounds too few? Well, you must leave some room for less optimized solutions :-) Also, CW would choke because of too much output...</p>
<hr>
<h2 id="my-other-katas">My other katas</h2>
<p>If you enjoyed this kata then please try <a href="https://www.codewars.com/collections/katas-created-by-anter69" target="_blank">my other katas</a>! :-)</p>
<h4 id="translations-are-welcome"><em>Translations are welcome!</em></h4>

### Solution